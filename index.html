<!DOCTYPE html>
<html lang="pl">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Spaceflight News</title>
    <link rel="stylesheet" href="main.css" />
  </head>
  <body>
    <form class="form">
      <label>Spaceflight articles</label>
      <input type="number" class="nb-news-input" />
      <input type="submit" class="button" />
    </form>

    <div class="container">
      <div class="news-list"></div>
    </div>

    <script>
      const NewsNumberUserInput = document.querySelector('.form');
      const newsList = document.querySelector('.news-list');

      NewsNumberUserInput.addEventListener('submit', loadNews);

      function loadNews(e) {
        newsList.innerText = '';
        e.preventDefault();
        let url = 'https://api.spaceflightnewsapi.net/v3/articles';

        fetch(url)
          .then((response) => {
            return response.json();
          })
          .then((data) => {
            data.forEach((news) => {
              let newsTitle = document.createElement('h2');
              let summaryField = document.createElement('p');
              let link = document.createElement('a');

              link.textContent = 'Read more';
              link.setAttribute('href', news.url);
              link.setAttribute('target', '_blank');
              newsTitle.textContent = news.title;

              if (news.summary.length - 200 <= 0) {
                summaryField.textContent = news.summary + ' ...';
              } else {
                summaryField.textContent =
                  news.summary.substring(0, 200) + ' ...';
              }

              newsList.appendChild(newsTitle);
              newsList.appendChild(summaryField);
              newsList.appendChild(link);
            });
          })
          .catch((error) => {
            console.log(error);
          });
      }
    </script>
  </body>
</html>
